make build --directory=kern
make[1]: 进入目录“/home/zrp/farmos/kern”
make build --directory=boot/
make[2]: 进入目录“/home/zrp/farmos/kern/boot”
riscv64-unknown-elf-gcc -Wall -Werror -fno-omit-frame-pointer -gdwarf-2 -MD -mcmodel=medany -ffreestanding -fno-common -nostdlib -mno-relax -I. -fno-stack-protector -DNCPU=2 -DQEMU -fno-pie -no-pie -DVIRT -O3 -I../../include -c main.c
make[2]: 离开目录“/home/zrp/farmos/kern/boot”
make build --directory=dev/
make[2]: 进入目录“/home/zrp/farmos/kern/dev”
make[2]: 对“build”无需做任何事。
make[2]: 离开目录“/home/zrp/farmos/kern/dev”
make build --directory=driver/
make[2]: 进入目录“/home/zrp/farmos/kern/driver”
make[2]: 对“build”无需做任何事。
make[2]: 离开目录“/home/zrp/farmos/kern/driver”
make build --directory=fs/
make[2]: 进入目录“/home/zrp/farmos/kern/fs”
make build --directory=fat32
make[3]: 进入目录“/home/zrp/farmos/kern/fs/fat32”
riscv64-unknown-elf-gcc -Wall -Werror -fno-omit-frame-pointer -gdwarf-2 -MD -mcmodel=medany -ffreestanding -fno-common -nostdlib -mno-relax -I. -fno-stack-protector -DNCPU=2 -DQEMU -fno-pie -no-pie -DVIRT -O3 -I../../../include -c chardev.c
riscv64-unknown-elf-gcc -Wall -Werror -fno-omit-frame-pointer -gdwarf-2 -MD -mcmodel=medany -ffreestanding -fno-common -nostdlib -mno-relax -I. -fno-stack-protector -DNCPU=2 -DQEMU -fno-pie -no-pie -DVIRT -O3 -I../../../include -c fat32init.c
riscv64-unknown-elf-gcc -Wall -Werror -fno-omit-frame-pointer -gdwarf-2 -MD -mcmodel=medany -ffreestanding -fno-common -nostdlib -mno-relax -I. -fno-stack-protector -DNCPU=2 -DQEMU -fno-pie -no-pie -DVIRT -O3 -I../../../include -c link.c
make[3]: 离开目录“/home/zrp/farmos/kern/fs/fat32”
make build --directory=fd
make[3]: 进入目录“/home/zrp/farmos/kern/fs/fd”
riscv64-unknown-elf-gcc -Wall -Werror -fno-omit-frame-pointer -gdwarf-2 -MD -mcmodel=medany -ffreestanding -fno-common -nostdlib -mno-relax -I. -fno-stack-protector -DNCPU=2 -DQEMU -fno-pie -no-pie -DVIRT -O3 -I../../../include -c fd.c
riscv64-unknown-elf-gcc -Wall -Werror -fno-omit-frame-pointer -gdwarf-2 -MD -mcmodel=medany -ffreestanding -fno-common -nostdlib -mno-relax -I. -fno-stack-protector -DNCPU=2 -DQEMU -fno-pie -no-pie -DVIRT -O3 -I../../../include -c pipe.c
make[3]: 离开目录“/home/zrp/farmos/kern/fs/fd”
make build --directory=proc
make[3]: 进入目录“/home/zrp/farmos/kern/fs/proc”
make[3]: 对“build”无需做任何事。
make[3]: 离开目录“/home/zrp/farmos/kern/fs/proc”
make build --directory=static_files
make[3]: 进入目录“/home/zrp/farmos/kern/fs/static_files”
make[3]: 对“build”无需做任何事。
make[3]: 离开目录“/home/zrp/farmos/kern/fs/static_files”
riscv64-unknown-elf-gcc -Wall -Werror -fno-omit-frame-pointer -gdwarf-2 -MD -mcmodel=medany -ffreestanding -fno-common -nostdlib -mno-relax -I. -fno-stack-protector -DNCPU=2 -DQEMU -fno-pie -no-pie -DVIRT -O3 -I../../include -c socket.c
make[2]: 离开目录“/home/zrp/farmos/kern/fs”
make build --directory=futex/
make[2]: 进入目录“/home/zrp/farmos/kern/futex”
make[2]: 对“build”无需做任何事。
make[2]: 离开目录“/home/zrp/farmos/kern/futex”
make build --directory=ipc/
make[2]: 进入目录“/home/zrp/farmos/kern/ipc”
riscv64-unknown-elf-gcc -Wall -Werror -fno-omit-frame-pointer -gdwarf-2 -MD -mcmodel=medany -ffreestanding -fno-common -nostdlib -mno-relax -I. -fno-stack-protector -DNCPU=2 -DQEMU -fno-pie -no-pie -DVIRT -O3 -I../../include -c shm.c
make[2]: 离开目录“/home/zrp/farmos/kern/ipc”
make build --directory=lib/
make[2]: 进入目录“/home/zrp/farmos/kern/lib”
make[2]: 对“build”无需做任何事。
make[2]: 离开目录“/home/zrp/farmos/kern/lib”
make build --directory=lock/
make[2]: 进入目录“/home/zrp/farmos/kern/lock”
make[2]: 对“build”无需做任何事。
make[2]: 离开目录“/home/zrp/farmos/kern/lock”
make build --directory=mm/
make[2]: 进入目录“/home/zrp/farmos/kern/mm”
riscv64-unknown-elf-gcc -Wall -Werror -fno-omit-frame-pointer -gdwarf-2 -MD -mcmodel=medany -ffreestanding -fno-common -nostdlib -mno-relax -I. -fno-stack-protector -DNCPU=2 -DQEMU -fno-pie -no-pie -DVIRT -O3 -I../../include -c kmalloc.c
make[2]: 离开目录“/home/zrp/farmos/kern/mm”
make build --directory=proc/
make[2]: 进入目录“/home/zrp/farmos/kern/proc”
riscv64-unknown-elf-gcc -Wall -Werror -fno-omit-frame-pointer -gdwarf-2 -MD -mcmodel=medany -ffreestanding -fno-common -nostdlib -mno-relax -I. -fno-stack-protector -DNCPU=2 -DQEMU -fno-pie -no-pie -DVIRT -O3 -I../../include -c dynamic_link.c
riscv64-unknown-elf-gcc -Wall -Werror -fno-omit-frame-pointer -gdwarf-2 -MD -mcmodel=medany -ffreestanding -fno-common -nostdlib -mno-relax -I. -fno-stack-protector -DNCPU=2 -DQEMU -fno-pie -no-pie -DVIRT -O3 -I../../include -c procarg.c
riscv64-unknown-elf-gcc -Wall -Werror -fno-omit-frame-pointer -gdwarf-2 -MD -mcmodel=medany -ffreestanding -fno-common -nostdlib -mno-relax -I. -fno-stack-protector -DNCPU=2 -DQEMU -fno-pie -no-pie -DVIRT -O3 -I../../include -c procinit.c
make[2]: 离开目录“/home/zrp/farmos/kern/proc”
make build --directory=signal/
make[2]: 进入目录“/home/zrp/farmos/kern/signal”
riscv64-unknown-elf-gcc -Wall -Werror -fno-omit-frame-pointer -gdwarf-2 -MD -mcmodel=medany -ffreestanding -fno-common -nostdlib -mno-relax -I. -fno-stack-protector -DNCPU=2 -DQEMU -fno-pie -no-pie -DVIRT -O3 -I../../include -c itimer.c
make[2]: 离开目录“/home/zrp/farmos/kern/signal”
make build --directory=syscall/
make[2]: 进入目录“/home/zrp/farmos/kern/syscall”
riscv64-unknown-elf-gcc -Wall -Werror -fno-omit-frame-pointer -gdwarf-2 -MD -mcmodel=medany -ffreestanding -fno-common -nostdlib -mno-relax -I. -fno-stack-protector -DNCPU=2 -DQEMU -fno-pie -no-pie -DVIRT -O3 -I../../include -c sys_mmap.c
riscv64-unknown-elf-gcc -Wall -Werror -fno-omit-frame-pointer -gdwarf-2 -MD -mcmodel=medany -ffreestanding -fno-common -nostdlib -mno-relax -I. -fno-stack-protector -DNCPU=2 -DQEMU -fno-pie -no-pie -DVIRT -O3 -I../../include -c sys_proc.c
riscv64-unknown-elf-gcc -Wall -Werror -fno-omit-frame-pointer -gdwarf-2 -MD -mcmodel=medany -ffreestanding -fno-common -nostdlib -mno-relax -I. -fno-stack-protector -DNCPU=2 -DQEMU -fno-pie -no-pie -DVIRT -O3 -I../../include -c sys_signal.c
make[2]: 离开目录“/home/zrp/farmos/kern/syscall”
make build --directory=trap/
make[2]: 进入目录“/home/zrp/farmos/kern/trap”
riscv64-unknown-elf-gcc -Wall -Werror -fno-omit-frame-pointer -gdwarf-2 -MD -mcmodel=medany -ffreestanding -fno-common -nostdlib -mno-relax -I. -fno-stack-protector -DNCPU=2 -DQEMU -fno-pie -no-pie -DVIRT -O3 -I../../include -c trap_timer.c
make[2]: 离开目录“/home/zrp/farmos/kern/trap”
make[1]: 离开目录“/home/zrp/farmos/kern”
make build --directory=lib
make[1]: 进入目录“/home/zrp/farmos/lib”
make[1]: 对“build”无需做任何事。
make[1]: 离开目录“/home/zrp/farmos/lib”
make build --directory=user
make[1]: 进入目录“/home/zrp/farmos/user”
riscv64-unknown-elf-gcc -Wall -Werror -fno-omit-frame-pointer -gdwarf-2 -MD -mcmodel=medany -ffreestanding -fno-common -nostdlib -mno-relax -I. -fno-stack-protector -DNCPU=2 -DQEMU -fno-pie -no-pie -DVIRT -O3 -I./include/ -I../include -c -o test_busybox.o test_busybox.c
riscv64-unknown-elf-ld -o test_busybox.b -z max-page-size=4096 -O --gc-sections -G 0 -static -n -nostdlib -T ../linker/user.ld entry.o test_busybox.o libMain.o syscallLib.o clone.o stdio.o stdlib.o string.o
riscv64-unknown-elf-objdump -D test_busybox.b > test_busybox.b.asm
python3 ../scripts/binToC.py test_busybox.b test_busybox.b.c
riscv64-unknown-elf-gcc -Wall -Werror -fno-omit-frame-pointer -gdwarf-2 -MD -mcmodel=medany -ffreestanding -fno-common -nostdlib -mno-relax -I. -fno-stack-protector -DNCPU=2 -DQEMU -fno-pie -no-pie -DVIRT -O3 -c -o test_busybox.x test_busybox.b.c
rm test_busybox.o test_busybox.b
make[1]: 离开目录“/home/zrp/farmos/user”
riscv64-unknown-elf-ld -z max-page-size=4096 -O --gc-sections -T linker/kernel.ld -o kernel-qemu kern/*/*.o lib/*.o user/*.x kern/*/*/*.o
riscv64-unknown-elf-objdump -xS kernel-qemu > kern/kernel.asm
cp sdcard.img fs.img
qemu-img resize fs.img 64M
Image resized.
qemu-system-riscv64 -machine virt -bios default -kernel kernel-qemu -m 128M -smp 2 -nographic -drive file=fs.img,if=none,format=raw,id=x0 -device virtio-blk-device,drive=x0,bus=virtio-mmio-bus.0 -device virtio-net-device

OpenSBI v1.0
   ____                    _____ ____ _____
  / __ \                  / ____|  _ \_   _|
 | |  | |_ __   ___ _ __ | (___ | |_) || |
 | |  | | '_ \ / _ \ '_ \ \___ \|  _ < | |
 | |__| | |_) |  __/ | | |____) | |_) || |_
  \____/| .__/ \___|_| |_|_____/|____/_____|
        | |
        |_|

Platform Name             : riscv-virtio,qemu
Platform Features         : medeleg
Platform HART Count       : 2
Platform IPI Device       : aclint-mswi
Platform Timer Device     : aclint-mtimer @ 10000000Hz
Platform Console Device   : uart8250
Platform HSM Device       : ---
Platform Reboot Device    : sifive_test
Platform Shutdown Device  : sifive_test
Firmware Base             : 0x80000000
Firmware Size             : 260 KB
Runtime SBI Version       : 0.3

Domain0 Name              : root
Domain0 Boot HART         : 0
Domain0 HARTs             : 0*,1*
Domain0 Region00          : 0x0000000002000000-0x000000000200ffff (I)
Domain0 Region01          : 0x0000000080000000-0x000000008007ffff ()
Domain0 Region02          : 0x0000000000000000-0xffffffffffffffff (R,W,X)
Domain0 Next Address      : 0x0000000080200000
Domain0 Next Arg1         : 0x0000000087000000
Domain0 Next Mode         : S-mode
Domain0 SysReset          : yes

Boot HART ID              : 0
Boot HART Domain          : root
Boot HART ISA             : rv64imafdcsuh
Boot HART Features        : scounteren,mcounteren,time
Boot HART PMP Count       : 16
Boot HART PMP Granularity : 4
Boot HART PMP Address Bits: 54
Boot HART MHPM Count      : 0
Boot HART MIDELEG         : 0x0000000000001666
Boot HART MEDELEG         : 0x0000000000f0b509
FarmOS kernel is booting (on hart 0) total: 2
Hart 0's vm is enabled, booting.
FarmOS kernel boot end, start all harts.
Hart 0 is waiting
Hart 1 started.
Hart 1's vm is enabled, booting.
Hart 1 is waiting
Hart 1 start running.
Hart 0 start running.
test_busybox started!
[test_init]: before execve! I'm 20001

$ /busybox ash lmbench_testcode.sh 
latency measurements
Simple syscall: 28.0206 microseconds
Simple read: 57.4963 microseconds
Simple write: 50.0543 microseconds
Simple stat: 127.6623 microseconds
Simple fstat: 76.7380 microseconds
Simple open/close: 176.7621 microseconds
Select on 100 fd's: 1416.8108 microseconds
Signal handler installation: 40.5816 microseconds
Signal handler overhead: 50.2361 microseconds
Protection fault: 32.2739 microseconds
Pipe latency: 198.3546 microseconds
Process fork+exit: 3438.5000 microseconds
Process fork+execve: 4064.8425 microseconds
Process fork+/bin/sh -c: 4228.0866 microseconds
File /var/tmp/XXX write bandwidth:1721 KB/sec
mmap: Operation not permitted
file system latency
0k[1m[31m[ERROR][0m[31m  1     dirent.c:80           dget()[0m: 'dirent->holder_cnt < DIRENT_HOLDER_CNT'

